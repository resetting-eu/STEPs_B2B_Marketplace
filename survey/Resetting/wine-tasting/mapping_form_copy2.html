<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <title>Contributos wine_tasting</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <style type="text/css">
      html {
        height: 100%;
      }
      body {
        height: 100%;
        margin: 0px;
        padding: 0px;
      }
      #map_canvas {
        height: 100%;
      }
      /* bootstrap fix */
      #map_canvas img {
        max-width: none;
      }
    </style>
    <!-- Google Maps and Places and Drawing API -->

    <!-- jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

    <!-- bootstrap -->
    <!-- <link rel="stylesheet" type="text/css" href="css/participeapi.css" /> -->
    <style>
      body,
      html {
        height: 100%;
        width: 100%;
      }

      body {
        color: rgba(6, 80, 73, 1);
        font: normal normal 10px/10px "PT Sans", Helvetica, Arial, Verdana,
          sans-serif;
      }
      .control-label {
        font-size: 1em;
        padding: 2px 0 0 0;
      }
      .input-xlarge {
        border-radius: 6px;
        display: block;
        border: 2px solid #dddddd;
        width: 95%;
        padding: 1px;
      }
      .input-xlargeL1 {
        border-radius: 6px;
        display: block;
        border: 2px solid #dddddd;
        width: 98%;
        height: 150px;
        padding: 1px;
      }
      .input-xlargeL {
        border-radius: 6px;
        display: block;
        border: 2px solid #dddddd;
        width: 98%;
        padding: 1px;
      }
      .btn-primary {
        background-color: rgba(8, 109, 99, 1);
        border-radius: 6px;
        border: 2px solid rgba(6, 80, 73, 1);
        box-shadow: 0 2px 2px #000;
        color: #ffffff;
        display: block;
        float: right;
        font-size: 1.6em;
        padding: 4px;
        font-size: 1.2em;
        text-decoration: none;
        text-shadow: 0 1px 2px #000;
        cursor: pointer;
        position: absolute;
        bottom: 5px;
        right: 70px;
      }
      .botaoacessos {
        background-color: rgba(8, 109, 99, 1);
        border-radius: 6px;
        border: 2px solid rgba(6, 80, 73, 1);
        box-shadow: 0 2px 2px #000;
        color: #ffffff;
        display: block;
        float: right;
        font-size: 1.6em;
        padding: 4px;
        font-size: 1.2em;
        text-decoration: none;
        text-shadow: 0 1px 2px #000;
        cursor: pointer;
        float: none;
      }
      .botaoaceitar {
        background-color: rgba(8, 109, 99, 1);
        border-radius: 6px;
        border: 2px solid rgba(6, 80, 73, 1);
        box-shadow: 0 2px 2px #000;
        color: #ffffff;
        display: block;
        float: right;
        font-size: 1.6em;
        padding: 4px;
        font-size: 1.2em;
        text-decoration: none;
        text-shadow: 0 1px 2px #000;
        cursor: pointer;
        position: absolute;
        bottom: 5px;
        right: 5px;
      }
      .actividades {
        border-radius: 12px;
        display: block;
        border: 2px solid #dddddd;
        width: 470px;
      }
      .actividades.hidesudo {
        display: none;
      }
      .acessos {
        border-radius: 12px;
        display: none;
        border: 2px solid #dddddd;
        width: 470px;
      }
      .acessos.showsudo {
        display: block;
      }

      .mapcanvasstyle {
        height: 10px;
        left: 0;
        position: fixed !important;
        top: 0;
        width: 100%;
        z-index: 1;
      } /* Has to be at least one increment smaller in value than the container's z-index */

      .submitdiv {
        display: block;
        background: rgba(240, 248, 255, 0.9);
        border: 5px solid rgba(6, 80, 73, 1);
        border-radius: 12px;
        overflow: visible !important;
        padding: 10px;
        position: absolute;
        top: 10px;
        right: 10px;
        width: 320px;
        z-index: 2;
        font-size: 1.4em;
      } /* Has to be at least one increment larger in value than the Google Maps iframe z-index */
      .APIpage_Submit {
        background: rgba(8, 109, 99, 1);
        border-radius: 12px;
        border: 2px solid rgba(6, 80, 73, 1);
        box-shadow: 0 2px 2px #000;
        color: #fff;
        display: block;
        float: right;
        font-size: 1.6em;
        padding-bottom: 18px;
        padding-top: 18px;
        font-size: 1.4em;
        text-decoration: none;
        text-shadow: 0 1px 2px #000;
      }
      input[type="button"]:disabled {
        background: #dddddd;
        border-color: #dddddd;
        color: #dddddd;
      }
      button[type="button"]:disabled {
        background: #dddddd;
        border-color: #dddddd;
        color: #dddddd;
      }
      .gm-style-iw + div {
        display: none;
      }

      .gm-style-iw {
        display: block;
        /* width: 100vw !important;
  height:100vh !important;
	   top: 0px !important;
   left: 0px !important; */
        background-color: #fff;
        border: 4px solid rgba(6, 80, 73, 1);
        border-radius: 12px 12px 12px 12px;
      }

      .mainDiv {
        width: 100vw;
        height: 100vh;
      }

      #selector-a {
        color: #fff;
        font-size: 1.4em;
        background-color: #143c00;
        opacity: 0.85;
      }

      #selector-b {
        color: #fff;
        font-size: 1.4em;
        background-color: #14a000;
        opacity: 0.85;
      }

      #selector-c {
        color: #5a5a5a;
        font-size: 1.4em;
        background-color: #14ff00;
        opacity: 0.85;
      }

      #selector-d {
        color: #5a5a5a;
        font-size: 1.4em;
        background-color: #dcdcdc;
        opacity: 0.85;
      }

      #selector-e {
        color: #000000;
        font-size: 1.4em;
        background-color: #ff0000;
        opacity: 0.85;
      }

      /*--------------------------------------------------------------------------------*/
      #drawingControlContainer {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
      }
      #vineyard_drawingControlContainer {
        position: relative;
        top: 0px;
        left: 0px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
      }
      #winery_drawingControlContainer {
        position: relative;
        top: 0px;
        left: 0px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
      }
      .drawButton {
        background: rgb(255, 255, 255) padding-box;
        display: block;
        border: 0px;
        margin: 0px;
        padding: 4px;
        text-transform: none;
        appearance: none;
        position: relative;
        cursor: pointer;
        user-select: none;
        direction: ltr;
        overflow: hidden;
        text-align: left;
        color: rgb(86, 86, 86);
        font-family: Roboto, Arial, sans-serif;
        font-size: 11px;
        box-shadow: rgba(0, 0, 0, 0.3) 0px 1px 4px -1px;
      }
    </style>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD06VoGtS9XbcWwkqcJx_VmL46nAI9H1vM&loading=async&libraries=places,drawing&v=weekly&callback=mapInitialize"
      async
      defer
    >
      //&callback=wine_tasting.initialize">//
    </script>
    
    <script>
      // function map_iterateChildren (element, additional) {

      //   const hasID = element.getAttribute("id");
      //   const hasChildren = element.children;
      //   if (hasID) {
      //     element.id = 'β' + additional + 'β' + hasID;
      //   }

      //   const eventAttributes = ["onclick", "onchange", "onmouseover", "onmouseout", "onselectstart", "onload", /* add other event attributes here */];

        




      //   for (const attr of eventAttributes) {
      //     let inlineJS = element.getAttribute(attr);
      //     if (inlineJS && inlineJS.includes('_')) {
      //       if (inlineJS.includes('.getElementById(')) {
      //         const first_split = inlineJS.split(';').join(',');
      //         const second_split = first_split.split('=').join(',');
      //         const third_split = second_split.split('+').join(',');
      //         const split_inlineJS = third_split.split(',');
      //         const regexp = /document\.getElementById\('(.*?)'\)/g;
      //         let split_targets_array = [];
      //         for (const split_str of split_inlineJS) {
      //           split_targets_array = [...split_targets_array, ...split_str.matchAll(regexp)];
      //         }
      //         const unique_targets_array = [...new Set(split_targets_array.map(JSON.stringify))].map(JSON.parse);
      //         for (const split_target of unique_targets_array) {
      //           inlineJS = inlineJS.replaceAll("'" + split_target[1] + "'", "'" + additional + 'β' + split_target[1] + "'");
      //           // there might be browser compatibility issues for old browsers with '''replaceAll()''' above, the regex below should do the same.
      //           // inlineJS = inlineJS.replace(new RegExp("'" + split_target[1] + "'", 'g'), "'" + 'β' + additional + 'β' + split_target[1] + "'");

      //         }
      //         element.setAttribute(attr, inlineJS);
      //       } else {
      //         if (inlineJS.includes("openDivVertical(")) {
      //           const originalCall_split = inlineJS.split("'");
      //           const changedCall = originalCall_split[0] + "'" + 'β' + additional + 'β' + originalCall_split[1] + "'" + originalCall_split[2];
      //           element.setAttribute(attr, changedCall);
      //         }
      //       }
      //     }
      //   }

      //   const hasFor = element.getAttribute("for");
      //   // console.log("hasFor",hasFor)
      //   if (hasFor) {
      //     element.htmlFor = 'β' + additional + 'β' + hasFor;
      //   }

      //   const hasName = element.getAttribute("name");
      //   if (hasName) {
      //     element.name = 'β' + additional + 'β' + hasName;
      //   }

      //   if (hasChildren.length > 0) {
      //     for (const child of hasChildren) {
      //       map_iterateChildren(child, additional)
      //     }
      //   }
      // // if (element.type === 'script') {
      // //   const innerScript = element.innerHTML;
      // //   if ()
      // //   const script = document.createElement('script');
      // //   script.text = element.text;
      // //   element.replaceWith(script);
      // // }

      // }

      // fetch('path/to/your/html/file.html')
      // .then(response => response.text())
      // .then(data => { var infowindow_content = data;
      //   // Call your mapping code here, to ensure that it runs after infowindow_content is loaded.
      //   // For example:
      //   // initializeMap(infowindow_content); }) .catch((error) => { console.error('

      // fetch("vineyard/vineyard_maintest.html")
      //   .then((response) => response.text())
      //   .then((data) => {
      //     var form = document.getElementById("vineyard_main");
      //     form.innerHTML = data;
      //     // Call your mapping code here, to ensure that it runs after infowindow_content is loaded.
      //     wine_tasting.initialize();
      //   })
      //   .catch((error) => {
      //     console.error("Error:", error);
      //   });

      //declare namespace
        // function structuredClone(obj) {
        //   return new Promise((resolve, reject) => {
        //     const { port1, port2 } = new MessageChannel();
        //     port2.onmessage = ev => resolve(ev.data);
        //     port1.postMessage(obj);
        //   });
        // }
      var infowindow_content;
      let formclone;
      let form;

      var firstPlotFlag = false;

      var wine_tasting = {};
      var mapOverlays = new Array();
      var mapInfowindows = new Array();

      //declare map

      var map;

      var mapStorageId;

      //set the drawing managers
      var drawingManager;
      var vineyard_drawingManager;
      var winery_drawingManager;

      function trace(message) {
        if (typeof console != "undefined") {
          console.log(message);
        }
      }

      //Function that gets run when the document loads
      function mapInitialize() {
        
        var myOptions = {
          zoom: 12,
          center: { lat: 38.49, lng: -9.064064 },
          // disableDefaultUI: true,
          // drawingControl: false, // Disable default control
          // controlSize: 20,
          mapTypeId: 'satellite',
          mapTypeControl: true, //enable/disable the map type control
          mapTypeControlOptions: {
            // controlSize: 20,
            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
            position: google.maps.ControlPosition.RIGHT_TOP,
          },
          panControl: true, // full screen enabler        
          zoomControl: true,
          zoomControlOptions: {
            // style: google.maps.ZoomControlStyle.SMALL,
            position: google.maps.ControlPosition.RIGTH_BOTTOM,
          },          
          streetViewControl: false,
        };

        map = new google.maps.Map(
          document.getElementById("map_canvas"),
          myOptions
        );

        //add the drawing tool that allows users to draw the vineyard plots on the map

        vineyard_drawingManager = new google.maps.drawing.DrawingManager({
          drawingControlOptions: {
            position: google.maps.ControlPosition.TOP_LEFT,
            drawingModes: [google.maps.drawing.OverlayType.POLYGON],
          },
          polygonOptions: {
            editable: true,
            draggable: true,
            strokeColor: "#f7f701",
            strokeWeight: 3,
            fillColor: "#f7f701",
            fillOpacity: 0.45,
          }, // polygons created are editable by default
          // drawingControl: true,
        });
        //add the tools to the map

        vineyard_drawingManager.setMap(map);
        // Add your custom control to the map
        // map.controls[google.maps.ControlPosition.TOP_LEFT].push(document.getElementById('drawingControlContainer'));

        // add the drawing tool that allows users to draw the winery sites on the map
        winery_drawingManager = new google.maps.drawing.DrawingManager({
          drawingControlOptions: {
            position: google.maps.ControlPosition.TOP_LEFT,
            drawingModes: [google.maps.drawing.OverlayType.POLYGON],
          },
          polygonOptions: {
            editable: true,
            draggable: true,
            strokeColor: "#38c4f2",
            strokeWeight: 3,
            fillColor: "#38c4f2",
            fillOpacity: 0.45,
          }, // polygons created are editable by default
        });

        //add the tools to the map
        winery_drawingManager.setMap(map);

        google.maps.event.addListenerOnce(map, "tilesloaded", function () {
          setTimeout(function () {
          console.log("Hello, map is loaded!");
          //   // do something only the first time the map is loaded
          //   // e.g. add a listener to the zoom_changed event
          //   google.maps.event.addListener(map, 'zoom_changed', function(){
          //     // do something here
          //   });

          // });

          // move drawing tools to the div with id="vineyard_drawingControlContainer"
          //  get the parent element of '''<div class="gmnoprint" role="menubar" style="margin: 5px; z-index: 10; position: absolute; left: 0px; top: 0px;">'
          var polDrawing = document.getElementsByClassName("gmnoprint");
          console.log("######### 0 #########");
          console.log(polDrawing);
          console.log(polDrawing.length);
          // iterate polDrawing to find the element that contains the drawing tools, i.e. has z-index: 10
          for (var i = 0; i < polDrawing.length; i++) {
            // console.log(polDrawing[i].style.zIndex);
            if (polDrawing[i].style.zIndex == 10) {
              var drawingTools = polDrawing[i].parentElement;

              break;
            }
          }
          console.log("######### 1 #########");
              console.log(drawingTools);
          
              let vineyardStart_Button = drawingTools.children[0].getElementsByTagName('button')[1];
              // set an id attribute to the first button element
              vineyardStart_Button.id = "vineyardStart_Button";
              // remove the style box-shadow attribute from the vineyardStart_Button
              vineyardStart_Button.style.boxShadow = "none";
              // move the vineyardStart_Button to the div with id="vineyardStart_Button_container"
              document.getElementById("vineyardStart_Button_container").appendChild(vineyardStart_Button);

              let vineyardStop_Button = drawingTools.children[0].getElementsByTagName('button')[0];
              // set an id attribute to the second button element
              vineyardStop_Button.id = "vineyardStop_Button";
              // remove the style box-shadow attribute from the vineyardStop_Button
              vineyardStop_Button.style.boxShadow = "none";
              // move the vineyardStop_Button to the div with id="vineyardStop_Button_container"
              document.getElementById("vineyardStop_Button_container").appendChild(vineyardStop_Button);

              let wineryStart_Button = drawingTools.children[1].getElementsByTagName('button')[1];
              // set an id attribute to the first button element
              wineryStart_Button.id = "wineryStart_Button";
              // remove the style box-shadow attribute from the wineryStart_Button
              wineryStart_Button.style.boxShadow = "none";
              // move the wineryStart_Button to the div with id="wineryStart_Button_container"
              document.getElementById("wineryStart_Button_container").appendChild(wineryStart_Button);

              let wineryStop_Button = drawingTools.children[1].getElementsByTagName('button')[0];
              // set an id attribute to the second button element
              wineryStop_Button.id = "wineryStop_Button";
              // remove the style box-shadow attribute from the wineryStop_Button
              wineryStop_Button.style.boxShadow = "none";
              // move the wineryStop_Button to the div with id="wineryStop_Button_container"
              document.getElementById("wineryStop_Button_container").appendChild(wineryStop_Button);

              // // move, prepending drawingTools first child to div with id="vineyard_drawingControlContainer"
              // document
              //   .getElementById("vineyard_drawingControlContainer")
              //   .prepend(drawingTools.children[0]);

              // // move, prepending drawingTools first child to div with id="winery_drawingControlContainer"
              // document
              //   .getElementById("winery_drawingControlContainer")
              //   .prepend(drawingTools.children[1]);


        //   // set the position attribute of the drawingTools element to relative
        //   drawingTools.children[0].style.position = "relative";
        //   drawingTools.children[1].style.position = "relative";

        //   // move, prepending drawingTools first child to div with id="vineyard_drawingControlContainer"
        //   document
        //     .getElementById("vineyard_drawingControlContainer")
        //     .prepend(drawingTools.children[0]);

        //   // move, prepending drawingTools first child to div with id="winery_drawingControlContainer"
        //   document
        //     .getElementById("winery_drawingControlContainer")
        //     .prepend(drawingTools.children[0]);

        // });
       
          }, 10);
        });        


        google.maps.event.addListener(
          vineyard_drawingManager,
          "overlaycomplete",
          function (dzenho) {
            // dzenho.overlay.prod_area = "" // maybe i need to force each new form to be 'empty'
            mapOverlays.push(dzenho.overlay);
            //---------------

            // hide map controls

            map.set("zoomControl", false);
            map.set("mapTypeControl", false);
            map.set("panControl", false);

            // hide the main container
            document.getElementById("toggle_box").style.display = "none";
            // Switch back to non-drawing mode after drawing a shape.

            // vineyard_drawingManager.setDrawingMode(null);
            // winery_drawingManager.setDrawingMode(null);

            // // hide drawing controls
            // vineyard_drawingManager.setOptions({
            //   drawingControl: false,
            // });
            // winery_drawingManager.setOptions({
            //   drawingControl: false,
            // });
            //---------------
            var w = window.innerWidth;
            var h = window.innerHeight;
            console.log("######## 2 #########");
            console.log("w", w, "h", h);
            //---------------

            if (dzenho.overlay.strokeColor == "#f7f701") {
              $(".prod_areas").addClass("hidesudo");
              $(".acessos").addClass("showsudo");

              // if (!firstPlotFlag){
                // firstPlotFlag = true;
//                 var infowindowContent_str = `
//                 <div class="form-horizontal save-form mainDiv" id="vineyard_main" name="vineyard_main">
//                   <div id="targetEl${mapInfowindows.length}"></div>
//                   <div class="form-actions">
//                     <button type="submit" class="btn-primary">Apagar</button>
//                     <button type="button" id="aceitar" class="botaoaceitar" onclick="infwinclose()">Aceitar</button>
//                   </div>
//                 </div>`;
// var infowindow_content = infowindowContent_str;
                

                          //"clone" the save-form to put in the infowindow

              var form = $("#vineyard_main_form").clone().show();
              // update the id of the "targetEl" div in the cloned form
              form[0].getElementsByClassName("targetEl")[0].id = `targetEl${mapInfowindows.length}`;

              
var infowindow_content = form[0];

              

              var infowindow = new google.maps.InfoWindow({                
                content: infowindow_content,                
                maxWidth: w,
                // position: google.maps.ControlPosition.TOP_LEFT,
                position: dzenho.overlay
                  .getPath()
                  .getAt(Math.round(dzenho.overlay.getPath().getLength() / 3)),
              });

              // // Set the content of the InfoWindow
              // infowindow.setContent(infowindow_content);
              // // Set the width of the InfoWindow
              // infowindow.setOptions({ maxWidth: w });
              // // Set the position of the InfoWindow
              // infowindow.setPosition(
              //   dzenho.overlay
              //     .getPath()
              //     .getAt(Math.round(dzenho.overlay.getPath().getLength() / 3))
              // );

              infowindow.open(map, dzenho.overlay);
              mapInfowindows.push(infowindow);

              // Add a listener for the 'domready' event
              google.maps.event.addListener(
                infowindow,
                "domready",
                function () {
                  // Now the content is loaded in the DOM, and you can access it
                  // var targetEl = document.getElementById('targetEl');
                    // firstPlotFlag = true;
                    // Fetch and execute the JavaScript code from 'constructorCode.js'
                    fetch("constructorCode.js")
                      .then((response) => response.text())
                      .then((data) => {
                        var targetEl = document.getElementById(
                          `targetEl${mapInfowindows.length - 1}`
                        ); // Make sure this is the correct element
                        console.log("########## 3 ##########")
                        console.log(`targetEl${mapInfowindows.length - 1}`);
                        console.log(
                          document.getElementById(
                            `targetEl${mapInfowindows.length - 1}`
                          )
                        );
                        // Encapsulate your constructorCode in an immediately invoked function expression (IIFE) to create a new scope for each execution
                        data = `(function(targetEl) { ${data} })(document.getElementById("targetEl${
                          mapInfowindows.length - 1
                        }"));`;
                        // console.log(data);
                        // generating new function Name
                        fName = `targetEl${mapInfowindows.length - 1}`;

                        // if(window[fName] === undefined){
                        //   console.log('fName: is not var')
                        //       window[fName] = new GraphCreator(caller);
                        // }
                        // Create a new Function object with the code as its body and call it
                        var result = new Function(fName, data);
                        console.log(
                          "################## 4 ####################"
                        );
                        console.log(result);
                        try {
                          result(targetEl);
                        } catch (error) {
                          console.error("Error:", error);
                        }
                        // result(targetEl);

                        
// console.log(document.getElementById(`targetEl${mapInfowindows.length - 1}`));
// document.getElementById(`targetEl${mapInfowindows.length - 1}`).addEventListener("change", () => {console.log("##################BAHHHHHHHHH!!!!####################")})
// function recursiveWait() {
//   if (!document.getElementById(`targetEl${mapInfowindows.length - 1}`).getElementsByTagName('html')[0])
//     setTimeout(recursiveWait, 1000);
//   else {
//     console.log(document.getElementById(`targetEl${mapInfowindows.length - 1}`).getElementsByTagName('html')[0]);
//     map_iterateChildren(document.getElementById(`targetEl${mapInfowindows.length - 1}`).getElementsByTagName('html')[0], mapInfowindows.length);
//   }
// }

// // select the target node
// var target = document.getElementById(`targetEl${mapInfowindows.length - 1}`);

// // create an observer instance
// var observer = new MutationObserver(function(mutations) {
//   mutations.forEach(function(mutation) {
//     if (document.getElementById("end_page_script")) {
//       observer.disconnect();
//       console.log('observer disconnected');
//       map_iterateChildren(document.getElementById(`targetEl${mapInfowindows.length - 1}`).getElementsByTagName('html')[0], mapInfowindows.length);
//     } else {
//       console.log('DOM change detected but "end_page_script" not found');
//     }
//   });
// });

// // configuration of the observer:
// var config = { attributes: true, childList: true, characterData: true, subtree: true };

// // pass in the target node, as well as the observer options
// observer.observe(target, config);


// if (!document.getElementById(`targetEl${mapInfowindows.length - 1}`).getElementsByTagName('html')[0])
// // console.log(document.getElementById(`targetEl${mapInfowindows.length}`))              
// console.log(document.getElementById(`targetEl${mapInfowindows.length - 1}`).getElementsByTagName('html')[0]);

//               map_iterateChildren(document.getElementById(`targetEl${mapInfowindows.length}`).getElementsByTagName('html')[0], mapInfowindows.length);



                      })
                      .catch((error) => console.error("Error:", error));
                      // infoWindow.setContent(document.getElementById("vineyard_main"));
                    // console.log("##################BAHHHHHHHHH!!!!####################");
                    // console.log(dzenho.overlay);
                  }                
              );
                
              // } else if (firstPlotFlag){

              //     // get the <html> element of mapInfowindows[0]
              //     // let targetEl = mapInfowindows[0].getContent().querySelector('html');
              //     console.log(mapInfowindows[0].getContent());

              //     infowindow.open(map, dzenho.overlay);
              // //     dzenho.overlay.reset();

              // // // Set the content of the InfoWindow
              // // infowindow.setContent(infowindow_content);
              // // // Set the width of the InfoWindow
              // // infowindow.setOptions({ maxWidth: w });
              // // // Set the position of the InfoWindow
              // // infowindow.setPosition(
              // //   dzenho.overlay
              // //     .getPath()
              // //     .getAt(Math.round(dzenho.overlay.getPath().getLength() / 3))
              // // );
              // // infowindow.open(map, dzenho.overlay);
              // // mapInfowindows.push(infowindow);

              // // // Add a listener for the 'domready' event
              // // google.maps.event.addListener(
              // //   infowindow,
              // //   "domready",
              // //   function () {
              // //     // Now the content is loaded in the DOM, and you can access it
              // //     // var targetEl = document.getElementById('targetEl');


  

              // //       console.log("##################BAHHHHHHHHH!!!!####################");
              // //     //       var newInfowindow = new google.maps.InfoWindow({
              // //     //   // content: infowindow_content,
              // //     //   maxWidth: w,
              // //     //   // position: google.maps.ControlPosition.TOP_LEFT,
              // //     //   position: dzenho.overlay
              // //     //     .getPath()
              // //     //     .getAt(Math.round(dzenho.overlay.getPath().getLength() / 3)),
              // //     // });
                                      
              // //     //   //deep clone the mapInfowindows[0]
              // //     //   // var newInfowindow = structuredClone(mapInfowindows[0]);
              // //     //   // set the content of the new infowindow
              // //     //   newInfowindow.setContent(mapInfowindows[0]);
              // //     //   // get the <body> element of the new infowindow
              // //     //   var targetEl = newInfowindow.getContent().querySelector('body');

              // //     //   // Reset all the form fields
              // //     //   targetEl.reset();






              // //       // // Fetch and execute the JavaScript code from 'constructorBodyCode.js'
              // //       // fetch("constructorBodyCode.js")
              // //       //   .then((response) => response.text())
              // //       //   .then((data) => {
              // //       //     var targetEl = document.getElementById(
              // //       //       `targetEl${mapInfowindows.length - 1}`
              // //       //     ); // Make sure this is the correct element
              // //       //     console.log(`targetEl${mapInfowindows.length - 1}`);
              // //       //     console.log(
              // //       //       document.getElementById(
              // //       //         `targetEl${mapInfowindows.length - 1}`
              // //       //       )
              // //       //     );
              // //       //     // Encapsulate your constructorCode in an immediately invoked function expression (IIFE) to create a new scope for each execution
              // //       //     data = `(function(targetEl) { ${data} })(document.getElementById("targetEl${
              // //       //       mapInfowindows.length - 1
              // //       //     }"));`;
              // //       //     // console.log(data);
              // //       //     // generating new function Name
              // //       //     fName = `targetEl${mapInfowindows.length - 1}`;

              // //       //     // if(window[fName] === undefined){
              // //       //     //   console.log('fName: is not var')
              // //       //     //       window[fName] = new GraphCreator(caller);
              // //       //     // }
              // //       //     // Create a new Function object with the code as its body and call it
              // //       //     var result = new Function(fName, data);
              // //       //     console.log(
              // //       //       "###########################################################"
              // //       //     );
              // //       //     console.log(result);
              // //       //     result(targetEl);
              // //       //   })
              // //       //   .catch((error) => console.error("Error:", error));
              // //     }
                
              // // );




              // }

            }
            //______________---X button
            google.maps.event.addListener(
              infowindow,
              "closeclick",
              function () {

                // if (!firstPlotFlag){
                // firstPlotFlag = true;
                // }

                // // get the index of infowindow on infowindows array
                // var index = mapInfowindows.indexOf(infowindow);
                // console.log("index", index);
                // // update the infowindow in the mapInfowindows array
                // mapInfowindows[index].content = infowindow.getContent();


                if (document.getElementById("aceitar").disabled == true) {
                  return false;
                } else if (
                  document.getElementById("aceitar").disabled == false
                ) {
                  $(".prod_areas").removeClass("hidesudo");
                  $(".acessos").removeClass("showsudo");

                  // show the main container
                  document.getElementById("toggle_box").style.display = "block";

                  // show map controls

                  map.set("zoomControl", true);

                  // show drawing controls

                  vineyard_drawingManager.setOptions({
                    drawingControl: false,
                    drawingControlOptions: {
                      position: google.maps.ControlPosition.TOP_LEFT,

                      drawingModes: [
                        google.maps.drawing.OverlayType.MARKER,

                        google.maps.drawing.OverlayType.POLYGON,

                        google.maps.drawing.OverlayType.POLYLINE,
                      ],
                    },

                    polygonOptions: {
                      editable: true,

                      strokeColor: "#80a68a",

                      strokeWeight: 3,

                      fillColor: "#80a68a",

                      fillOpacity: 0.45,
                    }, // polygons created are editable by default
                  });
                  map.setCenter(infowindow.position);
                }



              }
            );
            //______________---make each shape clickable

            google.maps.event.addListener(dzenho.overlay, "click", function () {
              //---------------

              // hide map controls

              map.set("zoomControl", false);

              // hide the main container
              document.getElementById("toggle_box").style.display = "none";

              // Switch back to non-drawing mode after drawing a shape.

              // vineyard_drawingManager.setDrawingMode(null);

              // hide drawing controls

              vineyard_drawingManager.setOptions({
                drawingControl: false,
              });

              //---------------
              if (dzenho.overlay.strokeColor == "#f7f701") {
                infowindow.open(map, dzenho.overlay);
                $(".prod_areas").addClass("hidesudo");
                $(".acessos").addClass("showsudo");
              } else if (
                (dzenho.type == "marker") |
                (dzenho.overlay.strokeColor == "#FF8C00")
              ) {
                infowindow.open(map, dzenho.overlay);
              }
            });
            // //______________---delete buton
            // form.submit({ dzenho: dzenho }, function (event) {
            //   $(".prod_areas").removeClass("hidesudo");
            //   $(".acessos").removeClass("showsudo");
            //   //prevent the default form behavior (which would refresh the page) . aqui pode ser a solução para popular todo o formlário se for usar o processo antigo.

            //   event.preventDefault();

            //   // show map controls

            //   map.set("zoomControl", true);

            //   // show drawing controls

            //   vineyard_drawingManager.setOptions({
            //     drawingControl: false,
            //     drawingControlOptions: {
            //       position: google.maps.ControlPosition.TOP_LEFT,

            //       drawingModes: [
            //         google.maps.drawing.OverlayType.MARKER,

            //         google.maps.drawing.OverlayType.POLYGON,

            //         google.maps.drawing.OverlayType.POLYLINE,
            //       ],
            //     },

            //     markerOptions: {
            //       // icon: new google.maps.MarkerImage('bus.png'),

            //       editable: true,

            //       draggable: true,
            //     }, // markers created are editable by default

            //     polygonOptions: {
            //       editable: true,

            //       strokeColor: "#FF8C00",

            //       strokeWeight: 3,

            //       fillColor: "#FF8C00",

            //       fillOpacity: 0.45,
            //     }, // polygons created are editable by default

            //     polylineOptions: {
            //       editable: true,

            //       strokeColor: "#FF8C00",

            //       strokeWeight: 3,
            //     }, // polylines created are editable by default
            //   });
            //   dzenho.overlay.setMap(null);

            //   //google.maps.InfoWindow.close();
            //   // then, remove the infowindows name from the array
            // });
            /*
             * O evento google.maps.event.addListener() espera pela
             * criação da estrutura HTML da infowindow 'domready'
             * e antes da abertura da infowindow serão aplicados
             * os estilos definidos
             */
            google.maps.event.addListener(infowindow, "domready", function () {
              // Referência ao DIV que recebe o conteúdo da infowindow recorrendo ao jQuery
              var iwOuter = $(".gm-style-iw");

              /* Uma vez que o div pretendido está numa posição anterior ao div .gm-style-iw.
               * Recorremos ao jQuery e criamos uma variável iwBackground,
               * e aproveitamos a referência já existente do .gm-style-iw para obter o div anterior com .prev().
               */
              var iwBackground = iwOuter.prev();

              // Remover o div da sombra do fundo
              iwBackground.children(":nth-child(2)").css({ display: "none" });

              // Remover o div de fundo branco
              iwBackground.children(":nth-child(4)").css({ display: "none" });
            });
          }
        );
      };

      function infwinclose() {
        // if (!firstPlotFlag){
        //         firstPlotFlag = true;

        //         }
        $(".prod_areas").removeClass("hidesudo");
        $(".acessos").removeClass("showsudo");

        // show map controls

        map.set("zoomControl", true);

        // show the main container
        document.getElementById("toggle_box").style.display = "block";

        // // show drawing controls

        // vineyard_drawingManager.setOptions({
        //   drawingControl: false,
        //   drawingControlOptions: {
        //     position: google.maps.ControlPosition.TOP_LEFT,

        //     drawingModes: [
        //       google.maps.drawing.OverlayType.MARKER,

        //       google.maps.drawing.OverlayType.POLYGON,

        //       google.maps.drawing.OverlayType.POLYLINE,
        //     ],
        //   },

        //   markerOptions: {
        //     // icon: new google.maps.MarkerImage('bus.png'),

        //     editable: true,

        //     draggable: true,
        //   }, // markers created are editable by default

        //   polygonOptions: {
        //     editable: true,

        //     strokeColor: "#FF8C00",

        //     strokeWeight: 3,

        //     fillColor: "#FF8C00",

        //     fillOpacity: 0.45,
        //   }, // polygons created are editable by default

        //   polylineOptions: {
        //     editable: true,

        //     strokeColor: "#80a68a",

        //     strokeWeight: 3,
        //   }, // polylines created are editable by default
        // });

        for (i = 0; i < mapInfowindows.length; i++) {
          mapInfowindows[i].close();
          map.setCenter(mapInfowindows[i].position);
        }
        // infowindow_content = "";
        
      }

      function acessosfunc() {
        // show map controls

        map.set("zoomControl", true);

        // show drawing controls

        vineyard_drawingManager.setOptions({
          drawingMode: google.maps.drawing.OverlayType.POLYLINE,
          drawingControl: true,
          drawingControlOptions: {
            position: google.maps.ControlPosition.TOP_LEFT,
            drawingModes: [
              //google.maps.drawing.OverlayType.MARKER,

              //google.maps.drawing.OverlayType.POLYGON,

              google.maps.drawing.OverlayType.POLYLINE,
            ],
          },

          polylineOptions: {
            editable: true,

            strokeColor: "#FFFF00",

            strokeWeight: 3,
          }, // polylines created are editable by default
        });

        for (i = 0; i < mapInfowindows.length; i++) {
          mapInfowindows[i].close();
        }
      }

      this.isnumber = function (evt) {
        evt = evt ? evt : window.event;

        var charCode = evt.which ? evt.which : evt.keyCode;

        if (charCode > 31 && (charCode < 48 || charCode > 57)) {
          return false;
        }

        return true;
      };

      function mapToDataObject() {
        for (var i = 0; i < mapOverlays.length; i++) {
          mapOverlays[i].prod_area = mapInfowindows[i].content.prod_area.value;
          mapOverlays[i].grape_vars =
            mapInfowindows[i].content.grape_vars.value;
          mapOverlays[i].justificacao =
            mapInfowindows[i].content.justificacao.value;
          mapOverlays[i].primavera = mapInfowindows[i].content.primavera.value;
          mapOverlays[i].verao = mapInfowindows[i].content.verao.value;
          mapOverlays[i].outono = mapInfowindows[i].content.outono.value;
          mapOverlays[i].inverno = mapInfowindows[i].content.inverno.value;
          mapOverlays[i].partmed = mapInfowindows[i].content.partmed.value;
          mapOverlays[i].partmax = mapInfowindows[i].content.partmax.value;
          mapOverlays[i].modalidade =
            mapInfowindows[i].content.modalidade.value;
          mapOverlays[i].moddiferentes =
            mapInfowindows[i].content.moddiferentes.value;
          mapOverlays[i].quais = mapInfowindows[i].content.quais.value;
          mapOverlays[i].proteccao = mapInfowindows[i].content.proteccao.value;
          mapOverlays[i].sugestoes = mapInfowindows[i].content.sugestoes.value;

          mapOverlays[i].transporte =
            mapInfowindows[i].content.transporte.value;
          mapOverlays[i].porqueacesso =
            mapInfowindows[i].content.porqueacesso.value;
          mapOverlays[i].sugestoesacesso =
            mapInfowindows[i].content.sugestoesacesso.value;
        }

        var tmpOverlay, paths;

        for (var i = 0; i < mapOverlays.length; i++) {
          if (mapOverlays[i].getMap() == null) {
            continue;
          }
          tmpOverlay = new Object();
          if (mapOverlays[i].type == "polygon") {
            tmpOverlay.paths = new Array();

            paths = mapOverlays[i].getPaths();

            for (var j = 0; j < paths.length; j++) {
              tmpOverlay.paths[j] = new Array();

              for (var k = 0; k < paths.getAt(j).length; k++) {
                tmpOverlay.paths[j][k] = {
                  lat: paths.getAt(j).getAt(k).lat().toString(),
                  lng: paths.getAt(j).getAt(k).lng().toString(),
                };
              }
              jQuery.ajax({
                url: "https://web.archive.org/web/20151009000557/https://docs.google.com/a/campus.fct.unl.pt/forms/d/1zqWMiZcv-ZpKjQcawmaV0S555ZLR8N80yl0Lk-43r4I/formResponse",
                data: {
                  "entry.1842183354": JSON.stringify(APIpage_autor.value),
                  "entry.1720390178": JSON.stringify(APIpage_entid.value),
                  "entry.1716839148": JSON.stringify(mapOverlays[i].type),
                  "entry.1697832013": JSON.stringify(tmpOverlay.paths),
                  "entry.1927026631": JSON.stringify(mapOverlays[i].prod_area),
                  "entry.631208417": JSON.stringify(mapOverlays[i].grape_vars),
                  "entry.1839150385": JSON.stringify(
                    mapOverlays[i].justificacao
                  ),
                  "entry.1208839541": JSON.stringify(mapOverlays[i].primavera),
                  "entry.1080778196": JSON.stringify(mapOverlays[i].verao),
                  "entry.837531257": JSON.stringify(mapOverlays[i].outono),
                  "entry.769952164": JSON.stringify(mapOverlays[i].inverno),
                  "entry.1300078572": JSON.stringify(mapOverlays[i].partmed),
                  "entry.986305950": JSON.stringify(mapOverlays[i].partmax),
                  "entry.1654551084": JSON.stringify(mapOverlays[i].modalidade),
                  "entry.834620682": JSON.stringify(
                    mapOverlays[i].moddiferentes
                  ),
                  "entry.553477634": JSON.stringify(mapOverlays[i].quais),
                  "entry.1938012869": JSON.stringify(mapOverlays[i].proteccao),
                  "entry.985236": JSON.stringify(mapOverlays[i].sugestoes),
                  "entry.821907459": JSON.stringify(mapOverlays[i].transporte),
                  "entry.1041184691": JSON.stringify(
                    mapOverlays[i].porqueacesso
                  ),
                  "entry.877936895": JSON.stringify(
                    mapOverlays[i].sugestoesacesso
                  ),
                  "entry.668953545": 0,
                },
                type: "POST",
                dataType: "jsonp",

                statusCode: {
                  0: function () {
                    //Success message
                  },
                  200: function () {
                    //Success Message
                  },
                },
              });
            }
          } else if (mapOverlays[i].type == "polyline") {
            tmpOverlay.path = new Array();

            path = mapOverlays[i].getPath();

            for (var j = 0; j < path.length; j++) {
              tmpOverlay.path[j] = {
                lat: path.getAt(j).lat().toString(),
                lng: path.getAt(j).lng().toString(),
              };
            }
            jQuery.ajax({
              url: "https://web.archive.org/web/20151009000557/https://docs.google.com/a/campus.fct.unl.pt/forms/d/1zqWMiZcv-ZpKjQcawmaV0S555ZLR8N80yl0Lk-43r4I/formResponse",
              data: {
                "entry.1842183354": JSON.stringify(APIpage_autor.value),
                "entry.1720390178": JSON.stringify(APIpage_entid.value),
                "entry.1716839148": JSON.stringify(mapOverlays[i].type),
                "entry.1697832013": JSON.stringify(tmpOverlay.path),
                "entry.1927026631": JSON.stringify(mapOverlays[i].prod_area),
                "entry.631208417": JSON.stringify(mapOverlays[i].grape_vars),
                "entry.1839150385": JSON.stringify(mapOverlays[i].justificacao),
                "entry.1208839541": JSON.stringify(mapOverlays[i].primavera),
                "entry.1080778196": JSON.stringify(mapOverlays[i].verao),
                "entry.837531257": JSON.stringify(mapOverlays[i].outono),
                "entry.769952164": JSON.stringify(mapOverlays[i].inverno),
                "entry.1300078572": JSON.stringify(mapOverlays[i].partmed),
                "entry.986305950": JSON.stringify(mapOverlays[i].partmax),
                "entry.1654551084": JSON.stringify(mapOverlays[i].modalidade),
                "entry.834620682": JSON.stringify(mapOverlays[i].moddiferentes),
                "entry.553477634": JSON.stringify(mapOverlays[i].quais),
                "entry.1938012869": JSON.stringify(mapOverlays[i].proteccao),
                "entry.985236": JSON.stringify(mapOverlays[i].sugestoes),
                "entry.821907459": JSON.stringify(mapOverlays[i].transporte),
                "entry.1041184691": JSON.stringify(mapOverlays[i].porqueacesso),
                "entry.877936895": JSON.stringify(
                  mapOverlays[i].sugestoesacesso
                ),
                "entry.668953545": 0,
              },
              type: "POST",
              dataType: "jsonp",

              statusCode: {
                0: function () {
                  //Success message
                },
                200: function () {
                  //Success Message
                },
              },
            });
          } else if (mapOverlays[i].type == "marker") {
            tmpOverlay.position = {
              lat: mapOverlays[i].getPosition().lat(),
              lng: mapOverlays[i].getPosition().lng(),
            };

            jQuery.ajax({
              url: "https://web.archive.org/web/20151009000557/https://docs.google.com/a/campus.fct.unl.pt/forms/d/1zqWMiZcv-ZpKjQcawmaV0S555ZLR8N80yl0Lk-43r4I/formResponse",
              data: {
                "entry.1842183354": JSON.stringify(APIpage_autor.value),
                "entry.1720390178": JSON.stringify(APIpage_entid.value),
                "entry.1716839148": JSON.stringify(mapOverlays[i].type),
                "entry.1697832013": JSON.stringify(tmpOverlay.position),
                "entry.1927026631": JSON.stringify(mapOverlays[i].prod_area),
                "entry.631208417": JSON.stringify(mapOverlays[i].grape_vars),
                "entry.1839150385": JSON.stringify(mapOverlays[i].justificacao),
                "entry.1208839541": JSON.stringify(mapOverlays[i].primavera),
                "entry.1080778196": JSON.stringify(mapOverlays[i].verao),
                "entry.837531257": JSON.stringify(mapOverlays[i].outono),
                "entry.769952164": JSON.stringify(mapOverlays[i].inverno),
                "entry.1300078572": JSON.stringify(mapOverlays[i].partmed),
                "entry.986305950": JSON.stringify(mapOverlays[i].partmax),
                "entry.1654551084": JSON.stringify(mapOverlays[i].modalidade),
                "entry.834620682": JSON.stringify(mapOverlays[i].moddiferentes),
                "entry.553477634": JSON.stringify(mapOverlays[i].quais),
                "entry.1938012869": JSON.stringify(mapOverlays[i].proteccao),
                "entry.985236": JSON.stringify(mapOverlays[i].sugestoes),
                "entry.821907459": JSON.stringify(mapOverlays[i].transporte),
                "entry.1041184691": JSON.stringify(mapOverlays[i].porqueacesso),
                "entry.877936895": JSON.stringify(
                  mapOverlays[i].sugestoesacesso
                ),
                "entry.668953545": 0,
              },
              type: "POST",
              dataType: "jsonp",

              statusCode: {
                0: function () {
                  //Success message
                },
                200: function () {
                  //Success Message
                },
              },
            });
          }
        }
        alert("Obrigado pelo seu contributo!");
        window.location.href = "http://wine_tasting.csites.fct.unl.pt";
      }

      function enabler() {
        if (
          (document.getElementById("APIpage_autor").value != "") &
          (document.getElementById("APIpage_entid").value != "")
        ) {
          document.getElementById("submeter").disabled = false;
        }
      }

      function formloader() {
        // alert($("prod_areas").val());
        /*
if (document.getElementById("prod_areas").value == "vineyard") {
alert(document.getElementById("prod_areas").value);
document.getElementById("option_prod_items").innerHTML = 'vineyards'
}
else if (document.getElementById("prod_areas").value == "winery") {
alert('winery');
document.getElementById("option_prod_items").innerHTML = 'winery'
}
else{
alert(document.getElementById("prod_areas").option);
document.getElementById("option_prod_items").innerHTML = 'other'
}
*/
      }
    </script>
    <!-- map location searcher-->
    <script id="js/map_search.js">
      /**
       * @license
       * Copyright 2019 Google LLC. All Rights Reserved.
       * SPDX-License-Identifier: Apache-2.0
       */
      // @ts-nocheck TODO remove when fixed
      // This example adds a search box to a map, using the Google Place Autocomplete
      // feature. People can enter geographical searches. The search box will return a
      // pick list containing a mix of places and predicted search terms.
      // This example requires the Places library. Include the libraries=places
      // parameter when you first load the API. For example:
      // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">
      function initAutocomplete() {
        /*const map = new google.maps.Map(document.getElementById("map"), {
    center: { lat: -33.8688, lng: 151.2195 },
    zoom: 13,
    mapTypeId: "roadmap",
  });*/
        // Create the search box and link it to the UI element.
        const input = document.getElementById("pac-input");
        const searchBox = new google.maps.places.SearchBox(input);

        //map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

        // Bias the SearchBox results towards current map's viewport.
        map.addListener("bounds_changed", () => {
          searchBox.setBounds(map.getBounds());
        });
        /*
  let markers = [];*/

        // Listen for the event fired when the user selects a prediction and retrieve
        // more details for that place.
        searchBox.addListener("places_changed", () => {
          const places = searchBox.getPlaces();

          if (places.length == 0) {
            return;
          }

          /*
    // Clear out the old markers.
    markers.forEach((marker) => {
      marker.setMap(null);
    });
    markers = [];
	*/

          // For each place, get the icon, name and location.
          const bounds = new google.maps.LatLngBounds();

          places.forEach((place) => {
            if (!place.geometry || !place.geometry.location) {
              console.log("Returned place contains no geometry");
              return;
            }

            const icon = {
              url: place.icon,
              size: new google.maps.Size(71, 71),
              origin: new google.maps.Point(0, 0),
              anchor: new google.maps.Point(17, 34),
              scaledSize: new google.maps.Size(25, 25),
            };
            /*
      // Create a marker for each place.
      markers.push(
        new google.maps.Marker({
          map,
          icon,
          title: place.name,
          position: place.geometry.location,
        }),
      );*/
            if (place.geometry.viewport) {
              // Only geocodes have viewport.
              bounds.union(place.geometry.viewport);
            } else {
              bounds.extend(place.geometry.location);
            }
          });
          map.fitBounds(bounds);
        });
      }

      //window.initAutocomplete = initAutocomplete;
    </script>
  </head>

  <body onload="mapInitialize()">
    //-------------------------------------------------------------------------------------------------------------------------------
    <div
      id="toggle_box"
      style="
        position: absolute;
        top: 0px;
        left: 0px;
        width: 15%;
        height: 95%;
        padding: 5px;
        background: rgba(240, 248, 255, 0.9);
        border: 5px solid rgba(6, 80, 73, 1);
        border-radius: 12px;
        z-index: 5;
      "
    >
      <input
        id="pac-input"
        class="controls"
        type="text"
        size="28vw"
        placeholder="Escolha uma localização aqui."
        oninput="initAutocomplete()"
      />

      <div id="mainContainer">
        <h1>Wine tasting experience form.</h1>
        <p>
          Clicking the icon lkjgkjglj below you can draw all your wine
          production plots on the map, you will be prompted to answer the forms
          for each plot. Aftwerwords, by clicking hghghjg you will be able to
          draw the area(s) pertainig your wineries and subsequently answer the
          form related to vinification and bottling.
        </p>

        <div id="drawingControlContainers">
          <div id="vineyard_drawingControlContainer" style="display: grid;">
            <span style="display: inline-block">
              Click <span style="display: inline-block;" id="vineyardStart_Button_container"></span> to draw a <b>vineyard plot</b>.</span><span>Click <span style="display: inline-block;" id="vineyardStop_Button_container"></span> to <b>disble drawing</b>.</span>
            <!-- <span style="display: inline-block">
              Click <span style="display: inline-block;"><div style="width: 16px; height: 16px; overflow: hidden; position: relative;"><img alt="" src="https://maps.gstatic.com/mapfiles/drawing.png" draggable="false" style="position: absolute; left: 0px; top: -64px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none; width: 16px; height: 192px;"></div></span> to draw a <b>vineyard plot</b>.</span><span>Click <span style="display: inline-block;"><div style="width: 16px; height: 16px; overflow: hidden; position: relative;"><img alt="" src="https://maps.gstatic.com/mapfiles/drawing.png" draggable="false" style="position: absolute; left: 0px; top: -144px; user-select: none; border: 0px; padding: 0px; margin: 0px; max-width: none; width: 16px; height: 192px;"></div></span> to <b>disble drawing</b>.</span> -->
            <!-- <button
              id="vineyard_drawButton"
              class="vineyard_drawButton drawButton"
              draggable="false"
              aria-label="Draw a shape"
              title="Draw a shape"
              type="button"
              role="menuitemradio"
              aria-checked="false"
            >
              <span style="display: inline-block"
                ><div
                  style="
                    display: inline-flex;
                    width: fit-content;
                    height: 16px;
                    overflow: hidden;
                    position: relative;
                  "
                >
                  <p>Select to draw grape land plots</p>
                  <img
                    style="
                      position: relative;
                      left: 0px;
                      top: -64px;
                      user-select: none;
                      border: 0px;
                      padding: 0px;
                      margin: 0px;
                      max-width: none;
                      width: 16px;
                      height: 192px;
                    "
                    alt=""
                    src="https://maps.gstatic.com/mapfiles/drawing.png"
                    draggable="false"
                  /></div
              ></span>
            </button> -->
          </br>
            <div id="vineyard_dynamicContent"><p>hello i am here!!!</p></div>
            <!-- Placeholder for dynamic table/list -->
          </div>

          <div id="winery_drawingControlContainer"  style="display: grid;">

            <span style="display: inline-block">
              Click <span style="display: inline-block;" id="wineryStart_Button_container"></span> to draw a <b>winery site</b>.</span><span>Click <span style="display: inline-block;" id="wineryStop_Button_container"></span> to <b>disble drawing</b>.</span>

            <!-- <button
              id="winery_drawButton"
              class="drawButton winery_drawButton"
              draggable="false"
              aria-label="Draw a shape"
              title="Draw a shape"
              type="button"
              role="menuitemradio"
              aria-checked="false"
            >
              <span style="display: inline-block"
                ><div
                  style="
                    display: inline-flex;
                    width: fit-content;
                    height: 16px;
                    overflow: hidden;
                    position: relative;
                  "
                >
                  <p>Select to draw winery areas</p>
                  <img
                    style="
                      position: relative;
                      left: 0px;
                      top: -64px;
                      user-select: none;
                      border: 0px;
                      padding: 0px;
                      margin: 0px;
                      max-width: none;
                      width: 16px;
                      height: 192px;
                    "
                    alt=""
                    src="https://maps.gstatic.com/mapfiles/drawing.png"
                    draggable="false"
                  /></div
              ></span>
            </button> -->
            <div id="winery_dynamicContent"></div>
            <!-- Placeholder for dynamic table/list -->
          </div>
        </div>
        <!-- Placeholder for drawing control -->
      </div>
    </div>
    //-------------------------------------------------------------------------------------------------------------------------------
    <!--                                                   -->
    <!-- map div container -->
    <!--<div id="map_canvas" style="height:100%; "></div>-->
    <div id="map_canvas" class="mapcanvasstyle"></div>

    <div class="form-horizontal save-form mainDiv" id="vineyard_main_form" name="vineyard_main_form">
      <div class="targetEl"></div>
      <div class="form-actions">
        <button type="submit" class="btn-primary">Apagar</button>
        <button type="button" id="aceitar" class="botaoaceitar" onclick="infwinclose()">Aceitar</button>
      </div>
    </div>

    <div
      id="google_translate_element"
      style="position: absolute; left: 15px; bottom: 15px; z-index: 2"
    ></div>
    <!--<textarea id="mapData" style="width:100%; height:300px"></textarea>-->
    <script>
      // JavaScript to add functionality to the custom button
      // document
      //   .getElementById("vineyard_drawButton")
      //   .addEventListener("click", function () {

      //     wine_tasting.initialize();
      //     // document.getElementsByClassName('vineyard_drawButton')[0].addEventListener('click', function() {
      //     // Set the drawing manager to polygon mode
      //     console.log("#0");
      //     console.log(vineyard_drawingManager);
      //     vineyard_drawingManager.setDrawingMode(
      //       google.maps.drawing.OverlayType.POLYGON
      //     );

      //     // to do: add disabled to the other drawing button
      //             - set the input element for geocoding innerHTML to ""
      //   });

      // JavaScript to add functionality to the custom button
      document
        .getElementById("winery_drawButton")
        .addEventListener("click", function () {
          // document.getElementsByClassName('winery_drawButton')[0].addEventListener('click', function() {
          // Set the drawing manager to polygon mode
          winery_drawingManager.setDrawingMode(
            google.maps.drawing.OverlayType.POLYGON
          );

          // to do: add disabled to the other drawing button
        });
    </script>
  </body>
</html>
<!--http://gmaps-samples-v3.googlecode.com/svn/trunk/smartinfowindow/smartinfowindow.html-->

<!-- d_resource: 368.455 -->
